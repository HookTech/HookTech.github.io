const CACHE_NAME="philo-site-v1.0.0",STATIC_CACHE="philo-static-v1.0.0",DYNAMIC_CACHE="philo-dynamic-v1.0.0",STATIC_ASSETS=["/","/css/main.css","/css/custom-animations.css","/css/homepage-enhancements.css","/css/performance-optimization.css","/js/boot.js","/js/events.js","/js/plugins.js","/js/custom-interactions.js","/js/homepage-interactions.js","/js/performance-optimization.js","/img/avatar.png","/img/default.png","/img/loading.gif"],DYNAMIC_ASSETS=["/archives/","/categories/","/tags/","/2025/08/04/Cursor-Usage/","/2018/07/09/Golden-Ratio-Fibonacci/"];function isStaticAsset(e){return e.includes("/css/")||e.includes("/js/")||e.includes("/img/")||e.includes("/fonts/")||e.endsWith(".css")||e.endsWith(".js")||e.endsWith(".png")||e.endsWith(".jpg")||e.endsWith(".jpeg")||e.endsWith(".gif")||e.endsWith(".svg")||e.endsWith(".woff")||e.endsWith(".woff2")}function isDynamicAsset(e){return e.includes("/archives/")||e.includes("/categories/")||e.includes("/tags/")||e.includes("/2025/")||e.includes("/2018/")}function preloadCriticalResources(){const e=["/css/performance-optimization.css","/js/performance-optimization.js"];return caches.open(STATIC_CACHE).then(s=>s.addAll(e))}self.addEventListener("install",e=>{console.log("Service Worker: Installing..."),e.waitUntil(caches.open(STATIC_CACHE).then(e=>(console.log("Service Worker: Caching static assets"),e.addAll(STATIC_ASSETS))).then(()=>(console.log("Service Worker: Static assets cached"),self.skipWaiting())).catch(e=>{console.error("Service Worker: Failed to cache static assets",e)}))}),self.addEventListener("activate",e=>{console.log("Service Worker: Activating..."),e.waitUntil(caches.keys().then(e=>Promise.all(e.map(e=>{if(e!==STATIC_CACHE&&e!==DYNAMIC_CACHE)return console.log("Service Worker: Deleting old cache",e),caches.delete(e)}))).then(()=>(console.log("Service Worker: Activated"),self.clients.claim())))}),self.addEventListener("fetch",e=>{const{request:s}=e;new URL(s.url).origin===location.origin&&"GET"===s.method&&e.respondWith(caches.match(s).then(e=>e||fetch(s).then(e=>{if(!e||200!==e.status||"basic"!==e.type)return e;const t=e.clone();return isStaticAsset(s.url)?caches.open(STATIC_CACHE).then(e=>{e.put(s,t)}):isDynamicAsset(s.url)&&caches.open(DYNAMIC_CACHE).then(e=>{e.put(s,t)}),e}).catch(e=>{if(console.error("Service Worker: Fetch failed",e),"document"===s.destination)return caches.match("/");throw e})))}),self.addEventListener("message",e=>{if(e.data&&"SKIP_WAITING"===e.data.type&&self.skipWaiting(),e.data&&"CACHE_URLS"===e.data.type){const s=e.data.payload;e.waitUntil(caches.open(DYNAMIC_CACHE).then(e=>e.addAll(s)))}}),self.addEventListener("sync",e=>{"background-sync"===e.tag&&e.waitUntil(preloadCriticalResources())}),console.log("Service Worker: Loaded successfully");